# Labbook 自动生成实验案例成功经验总结

本记录总结了在自动化生成 grid 拓扑实验 labbook 过程中积累的成功经验，旨在为后续高效组织和驱动 AI 生成 labbook 提供参考。

---

## 1. 明确需求与拓扑结构
- 先画出或描述清楚网络拓扑（如 grid、star、ring、tree 等），包括节点数、接口数、链路连接关系。
- 明确每个节点、接口、链路的属性需求（如 IP 分配、带宽、延迟、丢包等）。

## 2. 参数与资源分配自动化
- 用数据结构（如二维数组、字典）统一管理节点、接口、链路等信息，便于批量生成和查找。
- IP 分配、链路属性等采用自动递增、模板化，减少手工出错。

## 3. 事件与 timeline 组织
- 同类事件可聚合，output 事件需分开：如链路属性设置可聚合为一个 action，节点命令执行（带 output）需单独 action，便于追踪和调试。
- timeline 的 at 字段递增，保证事件顺序和可控性。

## 4. 代码结构清晰、可复用
- 分阶段组织代码：先分配资源（IP、链路），再生成节点、链路，最后生成事件和 timeline。
- 采用循环、函数封装等方式，便于拓扑规模扩展和复用。

## 5. 细节处理与健壮性
- 命令参数处理要严谨：如 ping 目标 IP 不带 mask，输出路径唯一且有规律。
- 检查每个接口、链路是否有对端，避免遗漏或重复。

## 6. 充分利用 builder API
- 善用 builder 的 template 方法和事件构造方法，减少底层细节操作。
- 聚合/分拆 action 时，灵活选择 build_network_events_action、build_netfunc_exec_output_event_action 等。

## 7. 及时验证与调试
- 每步生成后可打印/检查中间数据结构，确保逻辑正确。
- 生成的目录和配置文件可用工具或脚本自动校验。

## 8. 文档与注释
- 及时记录实验设计思路、参数分配规则、特殊处理逻辑，方便后续复用和团队协作。

---

### 总结性建议
- 先设计好“数据结构”与“生成流程”，再写代码，效率最高。
- 将“可批量、可模板化”的部分交给 AI 自动生成，特殊需求单独处理。
- 每次实验成功后，沉淀为模板或脚本，下次直接复用或微调。

如有更复杂的实验需求，建议提前整理“需求描述+参数规则”为结构化文档或伪代码，AI 可更快、更准确地生成 labbook 逻辑。 